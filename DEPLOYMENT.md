# ç§å‹ŸåŸºé‡‘æ•°æ®å¯è§†åŒ–ç³»ç»Ÿ - éƒ¨ç½²æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäº Next.js çš„ç§å‹ŸåŸºé‡‘æ•°æ®ç®¡ç†å’Œå¯è§†åŒ–ç³»ç»Ÿï¼ŒåŒ…å«ï¼š
- ğŸ“Š åŸºé‡‘æ•°æ®ç®¡ç†å’Œå¯è§†åŒ–
- ğŸ” å¤–éƒ¨ä¿¡æ¯ç›‘æ§ï¼ˆçˆ¬è™«ï¼‰
- ğŸš€ è‡ªåŠ¨åŒ–æ•°æ®åŒæ­¥åˆ°VPS

## ğŸ”§ æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: Next.js 15 + React 19
- **æ•°æ®åº“**: SQLite (better-sqlite3)
- **çˆ¬è™«**: Puppeteer
- **æ ·å¼**: Tailwind CSS
- **å›¾è¡¨**: Recharts

---

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/zbx0011/private-fund-visualization.git
cd private-fund-visualization
```

### 2. å®‰è£…ä¾èµ–

```bash
npm install
```

### 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
```

è®¿é—®ï¼šhttp://localhost:3000

---

## ğŸŒ é¡µé¢å¯¼èˆª

| è·¯å¾„ | è¯´æ˜ |
|------|------|
| `/` | æ€»è§ˆä»ªè¡¨æ¿ |
| `/charts` | æ•°æ®å›¾è¡¨ |
| `/manager` | äº§å“æ•°æ®ç®¡ç† |
| `/monitor` | å¤–éƒ¨ä¿¡æ¯ç›‘æ§ |

---

## ğŸ•·ï¸ çˆ¬è™«ä½¿ç”¨

### æ–¹æ³•ä¸€ï¼šä¸€é”®çˆ¬è™«ï¼ˆæ¨èï¼‰

**åŒå‡»è¿è¡Œï¼š** `scrape.bat`

è¯¥è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
1. å…³é—­æ‰€æœ‰Edgeè¿›ç¨‹
2. å¯åŠ¨çˆ¬è™«
3. ä¿å­˜æ•°æ®åˆ°æ•°æ®åº“

### æ–¹æ³•äºŒï¼šå‘½ä»¤è¡Œ

```bash
# ç¡®ä¿å…³é—­æ‰€æœ‰Edgeçª—å£
npm run scrape:edge -- "https://www.qyyjt.cn/combination/20250603164207"
```

### âš ï¸ é‡è¦æç¤º

- **å¿…é¡»å…ˆå…³é—­æ‰€æœ‰Edgeæµè§ˆå™¨çª—å£**ï¼Œå¦åˆ™ä¼šæŠ¥é”™
- çˆ¬è™«ä½¿ç”¨ä½ çš„Edgeä¸ªäººé…ç½®ï¼Œä¿ç•™ç™»å½•çŠ¶æ€
- æ•°æ®ä¼šè‡ªåŠ¨å»é‡å’Œæ¸…æ´—

### é…ç½®Edgeè·¯å¾„

å¦‚æœä½ çš„Edgeå®‰è£…åœ¨éé»˜è®¤ä½ç½®ï¼Œç¼–è¾‘ `scripts/scrape-with-edge-profile.js`:

```javascript
const EDGE_PATH = "ä½ çš„Edgeè·¯å¾„/msedge.exe";
const USER_DATA_DIR = "ä½ çš„Edgeç”¨æˆ·æ•°æ®è·¯å¾„";
```

å¸¸è§è·¯å¾„ï¼š
- **Windows é»˜è®¤**: `C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe`
- **ç”¨æˆ·æ•°æ®**: `C:\Users\[ç”¨æˆ·å]\AppData\Local\Microsoft\Edge\User Data`

---

## ğŸ”„ VPSåŒæ­¥

### åŒæ­¥æ•°æ®åº“åˆ°VPS

**æ–¹æ³•ä¸€ï¼šä»…åŒæ­¥æ•°æ®åº“**

åŒå‡»è¿è¡Œï¼š`sync-db-to-vps.bat`

**æ–¹æ³•äºŒï¼šåŒæ­¥ä»£ç +æ•°æ®åº“**

åŒå‡»è¿è¡Œï¼š`sync-all.bat`

### VPSé…ç½®ä¿¡æ¯

- **æœåŠ¡å™¨**: 172.245.53.67
- **ç”¨æˆ·**: root
- **å¯†ç **: Y6t1A5kp7f0PK3moOR
- **é¡¹ç›®è·¯å¾„**: `/var/www/private-fund-visualization`
- **è®¿é—®åœ°å€**: http://172.245.53.67:3000

### æ‰‹åŠ¨åŒæ­¥ï¼ˆå‘½ä»¤è¡Œï¼‰

```bash
# 1. ä¸Šä¼ æ•°æ®åº“
scp data/funds.db root@172.245.53.67:/var/www/private-fund-visualization/data/

# 2. æ›´æ–°ä»£ç 
git push origin main
ssh root@172.245.53.67 "cd /var/www/private-fund-visualization && git pull"
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
private-fund-visualization/
â”œâ”€â”€ data/                       # æ•°æ®åº“æ–‡ä»¶ï¼ˆä¸ä¸Šä¼ åˆ°Gitï¼‰
â”‚   â””â”€â”€ funds.db               # SQLiteæ•°æ®åº“
â”œâ”€â”€ scripts/                   # å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ scrape-with-edge-profile.js  # Edgeçˆ¬è™«
â”‚   â”œâ”€â”€ clean-monitor-data.js        # æ•°æ®æ¸…æ´—
â”‚   â”œâ”€â”€ clear-monitor-data.js        # æ¸…ç©ºæ•°æ®
â”‚   â””â”€â”€ restore-monitor-data.js      # æ¢å¤æ•°æ®
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/                   # Next.jsé¡µé¢
â”‚   â”œâ”€â”€ components/            # Reactç»„ä»¶
â”‚   â””â”€â”€ lib/                   # å·¥å…·å‡½æ•°
â”œâ”€â”€ scrape.bat                 # ä¸€é”®çˆ¬è™«
â”œâ”€â”€ sync-db-to-vps.bat        # åŒæ­¥æ•°æ®åº“åˆ°VPS
â””â”€â”€ sync-all.bat              # å®Œæ•´åŒæ­¥
```

---

## ğŸ—ƒï¸ æ•°æ®åº“ç®¡ç†

### æ¸…ç©ºå¤–éƒ¨ç›‘æ§æ•°æ®

```bash
node scripts/clear-monitor-data.js
```

è¿™ä¼šï¼š
1. å¤‡ä»½ç°æœ‰æ•°æ®åˆ° `data/monitor_backup.json`
2. æ¸…ç©º `external_monitor` è¡¨
3. é‡ç½®è‡ªå¢ID

### æ¢å¤å¤‡ä»½æ•°æ®

```bash
node scripts/restore-monitor-data.js
```

### æ¸…ç†è„æ•°æ®

```bash
node scripts/clean-monitor-data.js
```

ç§»é™¤æ•°æ®ä¸­çš„ï¼š
- "ä»…çœ‹æ­¤ç±»å‹å±è”½æ­¤ç±»å‹" åç¼€
- "æ–°é—» |" å‰ç¼€

---

## ğŸ› ï¸ å¼€å‘å‘½ä»¤

| å‘½ä»¤ | è¯´æ˜ |
|------|------|
| `npm run dev` | å¯åŠ¨å¼€å‘æœåŠ¡å™¨ |
| `npm run build` | æ„å»ºç”Ÿäº§ç‰ˆæœ¬ |
| `npm start` | è¿è¡Œç”Ÿäº§æœåŠ¡å™¨ |
| `npm run scrape:edge -- <URL>` | è¿è¡ŒEdgeçˆ¬è™« |

---

## ğŸš¨ å¸¸è§é—®é¢˜

### 1. çˆ¬è™«æŠ¥é”™ï¼šæµè§ˆå™¨å·²è¿è¡Œ

**åŸå› **: Edgeè¿›ç¨‹æœªå®Œå…¨å…³é—­

**è§£å†³**:
```bash
taskkill /F /IM msedge.exe /T
```

### 2. VPSæ•°æ®ä¸åŒæ­¥

**æ£€æŸ¥æ­¥éª¤**:
1. ç¡®è®¤æ•°æ®åº“å·²ä¸Šä¼ : `sync-db-to-vps.bat`
2. ç­‰å¾…30-60ç§’è®©Next.jsé‡æ–°åŠ è½½
3. åˆ·æ–°VPSé¡µé¢
4. å¦‚ä»æœªæ›´æ–°ï¼ŒSSHè¿›VPSæ‰‹åŠ¨é‡å¯æœåŠ¡

### 3. æœ¬åœ°å’ŒVPSæ•°æ®ä¸ä¸€è‡´

**æ‰‹åŠ¨å¯¹é½**:
```bash
# ä¸Šä¼ æœ€æ–°æ•°æ®åº“
scp data/funds.db root@172.245.53.67:/var/www/private-fund-visualization/data/
```

### 4. æ–°ç”µè„‘ä¸Šè¿è¡Œ

**æ­¥éª¤**:
1. å…‹éš†ä»£ç ï¼ˆè§"å¿«é€Ÿå¼€å§‹"ï¼‰
2. ä¿®æ”¹Edgeè·¯å¾„ï¼ˆå¦‚æœä¸æ˜¯é»˜è®¤ï¼‰
3. è¿è¡Œçˆ¬è™«è·å–æ•°æ®ï¼Œæˆ–ä»æ—§ç”µè„‘å¤åˆ¶ `data/funds.db`

---

## ğŸ” å®‰å…¨æ³¨æ„äº‹é¡¹

âš ï¸ **é‡è¦**: æœ¬æ–‡æ¡£åŒ…å«VPSå¯†ç ï¼Œè¯·å‹¿å°†æ­¤æ–‡ä»¶ä¸Šä¼ åˆ°å…¬å¼€ä»“åº“ï¼

å·²åœ¨ `.gitignore` ä¸­æ’é™¤ï¼š
- `data/` - æ•°æ®åº“æ–‡ä»¶
- `user_data/` - Edgeç”¨æˆ·æ•°æ®
- `*.db` - æ‰€æœ‰SQLiteæ•°æ®åº“

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Node.jsç‰ˆæœ¬ >= 18
2. npmä¾èµ–æ˜¯å¦å®Œæ•´å®‰è£…
3. Edgeæµè§ˆå™¨æ˜¯å¦å·²å®‰è£…
4. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### 2025-11-25
- âœ… æ·»åŠ Edgeä¸ªäººé…ç½®çˆ¬è™«
- âœ… å®ç°æ™ºèƒ½å»é‡ï¼ˆè·¨æ ‡ç­¾é¡µï¼‰
- âœ… è‡ªåŠ¨æ•°æ®æ¸…æ´—
- âœ… VPSæ•°æ®åº“åŒæ­¥è„šæœ¬
- âœ… å®Œæ•´éƒ¨ç½²æ–‡æ¡£
